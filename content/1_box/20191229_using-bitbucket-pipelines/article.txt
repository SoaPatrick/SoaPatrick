Title: Using Bitbucket Pipelines

----

Published: 2019-12-29

----

Cover: 

----

Format: standard

----

Category: Stuff thats happening

----

Tags: Development, Git

----

Project: 

----

Text: [{"content":{"text":"<p>In my <a href=\"\/box\/improve-deployment-process\/\" rel=\"noopener noreferrer\">last<\/a> post (I know it\u2019s been a while) I described my use of <a href=\"https:\/\/www.buddy.works\" target=\"_blank\" rel=\"noopener noreferrer\">Buddy.Works<\/a> for the deployment process. Well since <a href=\"https:\/\/bitbucket.org\/\" target=\"_blank\" rel=\"noopener noreferrer\">Bitbucket<\/a> uses its own deployment <strong>pipelines<\/strong> and because for work it was better to use the same tool for everything, I started to read up on pipelines.<\/p><p>The result is a <code>bitbucket-pipelines.yml<\/code> file for my Bitbucket Repository which handles the build and deployment process.<\/p>"},"id":"58edacf6-ab65-4eb3-8b80-44829fc65903","isHidden":false,"type":"text"},{"content":{"code":"image: node:10.15.3\n\npipelines:\n  branches:\n    master:\n    - step:\n        name: Build CSS\n        caches:\n          - node\n        script:\n          - npm install -g gulp\n          - npm install\n          - gulp sass\n        artifacts:\n          - style.css\n    - step:\n        name: Deploy Theme\n        deployment: production\n        script:\n          - pipe: atlassian\/rsync-deploy:0.3.2\n            variables:\n              USER: '$REMOTE_USER'\n              SERVER: '$REMOTE_SERVER'\n              REMOTE_PATH: '$REMOTE_PATH'\n              LOCAL_PATH: '\/opt\/atlassian\/pipelines\/agent\/build\/'\n              EXTRA_ARGS: '--exclude-from=deployment-exclude-list.txt'","language":"yaml"},"id":"b6ae4bc3-54b0-4f48-9842-62f1699d7a38","isHidden":false,"type":"code"},{"content":{"text":"<p>I\u2019m only working with a <code>master<\/code> branch but of course, you could expand that to a staging site with a <code>development<\/code> branch as well.<\/p><p>The first step builds the <code>CSS<\/code> out of the <code>SCSS<\/code> file and the second step uses <code>rsync<\/code> to copy the changed files from the repository to the remote server. There\u2019s also a <code>deployment-exclude-list.txt<\/code> with a few files which don\u2019t need to be copied.<\/p><p>Deployment now takes around 30-40 seconds and it\u2019s all neatly integrated into Bitbucket, which is kinda nice.<\/p><p>For now, I won\u2019t use Buddy.Works for a while, even though they have some very nice features and keep on adding new ones, like <a href=\"https:\/\/developers.google.com\/web\/tools\/lighthouse\" target=\"_blank\" rel=\"noopener noreferrer\">Lighthouse<\/a> testing. But maybe Bitbucket will add new features as well or I will find out how to include Lighthouse testing into my pipelines as well.<\/p>"},"id":"2322afb4-e00a-4fd1-b0e0-d5a5a92ac975","isHidden":false,"type":"text"}]

----

Linktext: 

----

Linkurl: 

----

Quotetext: 

----

Quotesource: 

----

Statustext: 

----

Old: 